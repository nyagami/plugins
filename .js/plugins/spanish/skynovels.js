var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,l)}a((o=o.apply(e,n||[])).next())}))},n=this&&this.__generator||function(e,n){var t,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(a){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(s=0)),s;)try{if(t=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return s.label++,{value:l[1],done:0};case 5:s.label++,o=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){s.label=l[1];break}if(6===l[0]&&s.label<i[1]){s.label=i[1],i=l;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(l);break}i[2]&&s.ops.pop(),s.trys.pop();continue}l=n.call(e,s)}catch(e){l=[6,e],o=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:1}}([l,a])}}};Object.defineProperty(exports,"__esModule",{value:1});var t=require("@libs/fetch"),o=function(){function o(){this.id="skynovels",this.name="SkyNovels",this.site="https://www.skynovels.net/",this.version="1.0.0",this.icon="src/es/skynovels/icon.png"}return o.prototype.popularNovels=function(o,i){var r;return e(this,void 0,void 0,(function(){var e,o;return n(this,(function(n){switch(n.label){case 0:return"https://api.skynovels.net/api/novels?&q",[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),o=[],null===(r=e.novels)||void 0===r||r.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",i={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};o.push(i)})),[2,o]}}))}))},o.prototype.parseNovel=function(o){var i,r,s;return e(this,void 0,void 0,(function(){var e,l,a,u,c,v,p;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[1],l="https://api.skynovels.net/api/novel/"+e+"/reading?&q",[4,(0,t.fetchApi)(l)];case 1:return[4,n.sent().json()];case 2:return a=n.sent(),u=null===(i=null==a?void 0:a.novel)||void 0===i?void 0:i[0],(c={path:o,name:(null==u?void 0:u.nvl_title)||"Untitled"}).cover="https://api.skynovels.net/api/get-image/"+(null==u?void 0:u.image)+"/novels/false",v=[],null===(r=null==u?void 0:u.genres)||void 0===r||r.forEach((function(e){return v.push(e.genre_name)})),c.genres=v.join(","),c.author=null==u?void 0:u.nvl_writer,c.summary=null==u?void 0:u.nvl_content,c.status=null==u?void 0:u.nvl_status,p=[],null===(s=null==u?void 0:u.volumes)||void 0===s||s.forEach((function(e){var n;null===(n=null==e?void 0:e.chapters)||void 0===n||n.forEach((function(e){var n={name:e.chp_index_title,releaseTime:new Date(e.createdAt).toDateString(),path:o+e.id+"/"+e.chp_name};p.push(n)}))})),c.chapters=p,[2,c]}}))}))},o.prototype.parseChapter=function(o){var i;return e(this,void 0,void 0,(function(){var e,r,s,l;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[3],r="https://api.skynovels.net/api/novel-chapter/".concat(e),[4,(0,t.fetchApi)(r)];case 1:return[4,n.sent().json()];case 2:return s=n.sent(),l=null===(i=null==s?void 0:s.chapter)||void 0===i?void 0:i[0],[2,(null==l?void 0:l.chp_content)||"404"]}}))}))},o.prototype.searchNovels=function(o,i){var r;return e(this,void 0,void 0,(function(){var e,i,s;return n(this,(function(n){switch(n.label){case 0:return o=o.toLowerCase(),"https://api.skynovels.net/api/novels?&q",[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),i=null===(r=null==e?void 0:e.novels)||void 0===r?void 0:r.filter((function(e){return e.nvl_title.toLowerCase().includes(o)})),s=[],null==i||i.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",o={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};s.push(o)})),[2,s]}}))}))},o.prototype.fetchImage=function(o){return e(this,void 0,void 0,(function(){return n(this,(function(e){return[2,(0,t.fetchFile)(o)]}))}))},o}();exports.default=new o;